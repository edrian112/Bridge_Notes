# 탭 네비게이션 및 과금 페이지 구현

## 완료된 작업

내부 탭 UI를 추가하여 히스토리와 과금 페이지를 분리했습니다.

## 새로 생성된 파일

### 1. TabNavigation.js
**경로**: `scripts/components/TabNavigation.js`

**기능**:
- 탭 전환 관리
- 활성 탭 상태 추적
- 탭 버튼 및 패널 동기화

**주요 메서드**:
```javascript
switchTab(tabName)      // 탭 전환
getCurrentTab()         // 현재 활성 탭 조회
goToTab(tabName)       // 프로그래매틱 탭 전환
```

### 2. Pricing.js
**경로**: `scripts/components/Pricing.js`

**기능**:
- 3가지 플랜 표시 (무료/프로/엔터프라이즈)
- 플랜별 기능 비교
- 데모 결제 프로세스
- 사용 제한 확인
- FAQ 섹션

**플랜 구성**:

#### 무료 플랜
- 가격: ₩0
- 월 10회 캡처
- 기본 AI 정리
- 히스토리 10개 저장
- 3가지 템플릿

#### 프로 플랜 (인기)
- 가격: ₩9,900/월
- 무제한 캡처
- 고급 AI 정리
- 히스토리 무제한
- 모든 템플릿
- n8n 워크플로우 연동
- 우선 지원

#### 엔터프라이즈
- 가격: ₩29,900/월
- 프로 플랜의 모든 기능
- 팀 협업 기능
- 커스텀 워크플로우
- 전용 지원
- API 액세스
- 온프레미스 옵션

**주요 메서드**:
```javascript
async loadCurrentPlan()           // 현재 플랜 불러오기
render()                          // 과금 페이지 렌더링
handlePlanSelection(planId)       // 플랜 선택 처리
async switchToFreePlan()          // 무료 플랜 전환
initiatePayment(plan)             // 결제 시작
async processDemoPayment(plan)    // 데모 결제 처리
getCurrentPlan()                  // 현재 플랜 조회
async checkLimit(action)          // 사용 제한 확인
async incrementUsage()            // 사용 횟수 증가
```

## UI 구조

### 탭 네비게이션
```
+----------------------------------+
| [📋 히스토리]  [💎 플랜]          |  ← 탭 버튼
+----------------------------------+
| 선택된 탭의 컨텐츠...             |
|                                  |
+----------------------------------+
```

### 히스토리 탭 (첫 번째 탭)
- 기존 히스토리 섹션 그대로 유지
- 최근 3개 캡처 표시
- 클릭하여 불러오기
- 삭제 기능

### 플랜 탭 (두 번째 탭)
```
💎 플랜 선택
나에게 맞는 플랜을 선택하세요

+----------------+  +----------------+  +----------------+
| 무료 플랜      |  | 프로 플랜      |  | 엔터프라이즈   |
| [현재 플랜]    |  | [인기]         |  |                |
|                |  |                |  |                |
| ₩0             |  | ₩9,900/월      |  | ₩29,900/월     |
|                |  |                |  |                |
| ✓ 월 10회 캡처 |  | ✓ 무제한 캡처  |  | ✓ 모든 기능    |
| ✓ 기본 AI      |  | ✓ 고급 AI      |  | ✓ 팀 협업      |
| ...            |  | ...            |  | ...            |
|                |  |                |  |                |
| [현재 플랜]    |  | [구매하기]     |  | [구매하기]     |
+----------------+  +----------------+  +----------------+

자주 묻는 질문
💳 결제 수단은 무엇이 있나요?
🔄 플랜 변경이 가능한가요?
💰 환불 정책은 어떻게 되나요?
📧 문의는 어떻게 하나요?
```

## 스타일링

### 탭 네비게이션 스타일
- 상단 고정 탭 바
- 활성 탭 하단 보더 강조 (#667eea)
- 호버 시 배경색 변경
- 부드러운 전환 애니메이션

### 과금 페이지 스타일
- **플랜 카드**: 흰색 배경, 보더, 호버 효과
- **추천 플랜**: 보라색 보더, 그림자 강조
- **현재 플랜**: 회색 배경, 비활성 버튼
- **배지**: 상단 우측 표시 (인기/현재 플랜)
- **기능 아이템**: 체크 아이콘, 구분선
- **FAQ**: 왼쪽 보더 강조

### 다크 모드 지원
- 모든 탭 요소 다크 모드 적용
- 과금 페이지 완전 지원
- 일관된 색상 팔레트 유지

## Chrome Storage

### 저장되는 데이터
```javascript
{
  userPlan: 'free' | 'pro' | 'enterprise',  // 현재 플랜
  planPurchaseDate: timestamp,               // 구매 날짜
  usageCount: number,                        // 이번 달 사용 횟수
  usageMonth: number                         // 사용 추적 월 (0-11)
}
```

## 데모 모드

현재는 **데모 모드**로 작동합니다:
- 실제 결제는 진행되지 않음
- 플랜 구매 시 확인 메시지 표시
- 2초 딜레이 후 "구매 완료" 처리
- Chrome Storage에 플랜 정보 저장

### 실제 결제 연동 시 수정 필요 사항
```javascript
// Pricing.js의 initiatePayment() 메서드 수정
initiatePayment(plan) {
  // TODO: 실제 결제 API 연동
  // 1. 결제 게이트웨이 호출 (토스페이먼츠, 아임포트 등)
  // 2. 결제 완료 콜백 처리
  // 3. 백엔드 서버에 구매 정보 저장
  // 4. 플랜 활성화
}
```

## 사용 제한 기능

### 무료 플랜 제한
```javascript
// 캡처 시 제한 확인
const canCapture = await this.pricing.checkLimit('capture');
if (!canCapture) {
  // 제한 초과 메시지 표시
  return;
}

// 캡처 성공 시 사용 횟수 증가
await this.pricing.incrementUsage();
```

### 월별 초기화
- 매월 1일에 사용 횟수 자동 초기화
- `usageMonth` 비교로 월 변경 감지

## 통합 완료

### sidepanel.html
- 히스토리 섹션을 탭 안으로 이동
- 탭 네비게이션 HTML 추가
- 과금 탭 컨테이너 추가

### sidepanel.css
- 탭 네비게이션 스타일 (300+ 라인)
- 과금 페이지 스타일
- 다크 모드 완전 지원

### sidepanel.js
```javascript
// 컴포넌트 인스턴스 생성
this.tabNavigation = new TabNavigation();
this.pricing = new Pricing(this.toast, this.errorHandler);
```

## 향후 개선 사항

### 1. 실제 결제 연동
- 토스페이먼츠 / 아임포트 등 PG사 연동
- 정기 결제 구독 시스템
- 결제 내역 관리

### 2. 백엔드 연동
- 사용자 플랜 서버 동기화
- 사용 횟수 서버 추적
- 결제 내역 저장

### 3. 추가 기능
- 플랜 비교 테이블
- 연간 결제 할인 옵션
- 팀 플랜 추가
- 쿠폰/프로모션 코드

### 4. 분석 및 추적
- 플랜 전환율 추적
- A/B 테스트
- 가격 최적화

## 테스트 방법

### 1. 탭 전환
1. 확장 프로그램 로드
2. 하단 "📋 히스토리" / "💎 플랜" 버튼 클릭
3. 탭 전환 확인

### 2. 플랜 보기
1. "💎 플랜" 탭 클릭
2. 3개 플랜 카드 표시 확인
3. 무료 플랜에 "현재 플랜" 배지 확인
4. 프로 플랜에 "인기" 배지 확인

### 3. 데모 결제
1. "프로 플랜" 또는 "엔터프라이즈" 구매 버튼 클릭
2. 확인 메시지 확인 (데모 모드 안내)
3. "확인" 클릭
4. 2초 후 구매 완료 토스트 메시지
5. 플랜 카드 업데이트 확인 (현재 플랜 배지 이동)

### 4. 무료 플랜 전환
1. 유료 플랜 구매 후
2. 무료 플랜 "무료로 시작" 버튼 클릭
3. 즉시 무료 플랜으로 전환 확인

### 5. 다크 모드
1. 설정 → 다크 모드 활성화
2. 플랜 탭에서 다크 모드 확인
3. 모든 요소 다크 스타일 적용 확인

## 완료!

탭 네비게이션과 과금 페이지 구현이 완료되었습니다. 🎉

**다음 단계 제안**:
1. 실제 결제 게이트웨이 연동
2. 백엔드 API 구축
3. 사용 제한 로직을 캡처 기능에 통합
4. 플랜별 기능 제한 추가 구현
